<div class="employee-management-container">
  <!-- Enhanced Header Section -->
  <div class="page-header">
    <div class="header-left">
      <div class="page-title">
        <mat-icon class="title-icon">people</mat-icon>
        <div class="title-content">
          <h1>Employee Management</h1>
          <p>Comprehensive employee records and management system</p>
        </div>
      </div>
    </div>
    <div class="header-actions">
      <button 
        mat-raised-button 
        class="add-employee-btn"
        (click)="openEmployeeForm()">
        <mat-icon>person_add</mat-icon>
        Add New Employee
      </button>
    </div>
  </div>

  <!-- Enhanced Search and Filter Section -->
  <mat-card class="filter-card">
    <mat-card-content>
      <div class="filter-row">
        <div class="search-section">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>Search Employees</mat-label>
            <input 
              matInput 
              placeholder="Search by name, email, ID, or department"
              (keyup)="applyFilter($event)"
              #searchInput>
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>
        </div>
        <div class="filter-actions">
          <button 
            mat-button 
            class="filter-btn"
            (click)="clearSearch()"
            [disabled]="!searchInput.value">
            <mat-icon>clear</mat-icon>
            Clear
          </button>
          <button 
            mat-button 
            class="export-btn">
            <mat-icon>download</mat-icon>
            Export
          </button>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Enhanced Data Table -->
  <mat-card class="table-card">
    <div class="table-container">
      <table mat-table [dataSource]="dataSource" class="employee-table" matSort>
        
        <!-- Employee ID Column -->
        <ng-container matColumnDef="employee_id">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <div class="header-content">
              <mat-icon>badge</mat-icon>
              Employee ID
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="employee-id-cell">
              <span class="employee-id">{{ employee.employee_id }}</span>
            </div>
          </td>
        </ng-container>

        <!-- Employee Info Column (Combined Name and Email) -->
        <ng-container matColumnDef="employee_info">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <div class="header-content">
              <mat-icon>person</mat-icon>
              Employee Information
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="employee-info-cell">
              <div class="employee-name">{{ employee.first_name }} {{ employee.last_name }}</div>
              <div class="employee-email">{{ employee.email }}</div>
            </div>
          </td>
        </ng-container>

        <!-- Contact Information Column -->
        <ng-container matColumnDef="contact_info">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-content">
              <mat-icon>contact_phone</mat-icon>
              Contact Information
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="contact-info-cell">
              <div class="phone-number">
                <mat-icon class="info-icon">phone</mat-icon>
                {{ employee.phone || 'N/A' }}
              </div>
            </div>
          </td>
        </ng-container>

        <!-- Role & Department Column -->
        <ng-container matColumnDef="role_department">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <div class="header-content">
              <mat-icon>work</mat-icon>
              Role & Department
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="role-department-cell">
              <div class="employee-role">{{ employee.role }}</div>
              <div class="employee-department">{{ employee.department || 'Unassigned' }}</div>
            </div>
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header>
            <div class="header-content">
              <mat-icon>flag</mat-icon>
              Status
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="status-cell">
              <span class="status-badge" [ngClass]="'status-' + employee.status?.toLowerCase()">
                <mat-icon class="status-icon">{{ getStatusIcon(employee.status) }}</mat-icon>
                {{ employee.status | titlecase }}
              </span>
            </div>
          </td>
        </ng-container>

        <!-- Management Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>
            <div class="header-content">
              <mat-icon>settings</mat-icon>
              Management Actions
            </div>
          </th>
          <td mat-cell *matCellDef="let employee">
            <div class="management-actions">
              <!-- View Details Button -->
              <button 
                mat-button 
                class="action-btn view-btn"
                (click)="viewEmployee(employee)"
                matTooltip="View Employee Details">
                <mat-icon>visibility</mat-icon>
                <span class="btn-text">View</span>
              </button>

              <!-- Edit Employee Button -->
              <button 
                mat-button 
                class="action-btn edit-btn"
                (click)="openEmployeeForm(employee)"
                matTooltip="Edit Employee Information">
                <mat-icon>edit</mat-icon>
                <span class="btn-text">Edit</span>
              </button>

              <!-- Email Employee Button -->
              <button 
                mat-button 
                class="action-btn email-btn"
                (click)="sendEmail(employee)"
                matTooltip="Send Email to Employee">
                <mat-icon>email</mat-icon>
                <span class="btn-text">Email</span>
              </button>

              <!-- Reset Password Button -->
              <button 
                mat-button 
                class="action-btn password-btn"
                (click)="resetPassword(employee)"
                matTooltip="Reset Employee Password">
                <mat-icon>lock_reset</mat-icon>
                <span class="btn-text">Password</span>
              </button>

              <!-- Delete Employee Button -->
              <button 
                mat-button 
                class="action-btn delete-btn"
                (click)="deleteEmployee(employee)"
                matTooltip="Delete Employee">
                <mat-icon>delete</mat-icon>
                <span class="btn-text">Delete</span>
              </button>
            </div>
          </td>
        </ng-container>

        <!-- Table Header and Rows -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row 
            *matRowDef="let employee; columns: displayedColumns;" 
            class="employee-row"
            [class.selected]="selectedEmployee?.id === employee.id"
            (click)="selectEmployee(employee)">
        </tr>
      </table>

      <!-- Loading State -->
      <div *ngIf="loading" class="loading-state">
        <div class="loading-content">
          <mat-spinner diameter="60"></mat-spinner>
          <h3>Loading Employee Data</h3>
          <p>Please wait while we fetch employee information...</p>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!loading && dataSource.data.length === 0" class="empty-state">
        <div class="empty-content">
          <mat-icon class="empty-icon">people_outline</mat-icon>
          <h2>No Employees Found</h2>
          <p>{{ searchInput.value ? 'No employees match your search criteria.' : 'Your organization has no employees registered yet.' }}</p>
          <div class="empty-actions">
            <button 
              mat-raised-button 
              class="primary-action"
              (click)="openEmployeeForm()"
              *ngIf="!searchInput.value">
              <mat-icon>person_add</mat-icon>
              Add First Employee
            </button>
            <button 
              mat-button 
              class="secondary-action"
              (click)="clearSearch()"
              *ngIf="searchInput.value">
              <mat-icon>clear</mat-icon>
              Clear Search
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Table Footer with Pagination Info -->
    <div class="table-footer" *ngIf="!loading && dataSource.data.length > 0">
      <div class="footer-info">
        <span class="employee-count">
          <strong>{{ dataSource.data.length }}</strong> employee{{ dataSource.data.length !== 1 ? 's' : '' }} total
        </span>
      </div>
      <div class="footer-actions">
        <button mat-button class="footer-btn" (click)="refreshData()">
          <mat-icon>refresh</mat-icon>
          Refresh
        </button>
      </div>
    </div>
  </mat-card>
</div>